@model E_voting_System.Models.ListViewModel
@{
    ViewBag.Title = "Lists";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
 

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<div class="container my-4">
    <h2 class="text-center mb-4">القوائم المحلية والحزبية</h2>
    <!-- Search Bar -->
    <div class="row mb-4">
        <div class="col-md-6 offset-md-3">
            <input type="text" id="listSearchInput" class="form-control" placeholder="ابحث عن قائمة..." onkeyup="filterLists()">
        </div>
    </div>
    <!-- Local Lists -->
    <h3>القوائم المحلية</h3>
    <div class="row">
        @foreach (var localList in Model.LocalLists)
        {
            <div class="col-md-4 mb-4 list-card" data-list-name="@localList.list_Name">
                <div class="card h-100 shadow-sm">
                    <div class="card-header text-white" style="background-color: #002d72;">
                        @localList.list_Name
                    </div>
                    <div class="card-body">
                        @if (localList.Circle_ID == 1)
                        {
                            <p>دائرة اربد الاولى</p>
                        }
                        @if (localList.Circle_ID == 2)
                        {
                            <p>دائرة اربد الثانية</p>
                        }
                        @if (localList.Circle_ID == 3)
                        {
                            <p>دائرة جرش</p>
                        }

                        @if (!string.IsNullOrEmpty(localList.List_Logo))
                        {
                            <img src="@Url.Content("~/Content/Uploads/" + localList.List_Logo)" alt="Local List Image" class="img-fluid" />
                        }
                        <h5>المرشحين</h5>
                        <ul class="list-unstyled">
                            @if (Model.CandidatesByList.ContainsKey(localList.ID))
                            {
                                <div class="table-responsive">
                                    <table class="table table-bordered table-sm">
                                        <thead class="table-light">
                                            <tr>
                                                <th>الرقم الوطني</th>
                                                <th>الاسم</th>
                                                <th>نوع الكرسي</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var candidate in Model.CandidatesByList[localList.ID])
                                            {
                                                <tr>
                                                    <td>@candidate.National_ID</td>
                                                    <td>@candidate.Candidate_Name</td>
                                                    <td>@candidate.Type_Of_Chair</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            }
                            else
                            {
                                <p class="text-center text-muted">لا يوجد مرشحين</p>
                            }
                    </div>
                    <div class="card-footer text-center">
                        <div id="localListActions_@localList.ID">
                            @if (localList.Status == "Approved" || localList.Status == "Rejected")
                            {
                                <span class="status-text">@localList.Status</span>
                            }
                            else
                            {
                                <button class="btn btn-success" type="submit" onclick="showApprovalAlert(@localList.ID)">Approve</button>
                                <button class="btn btn-danger" onclick="showRejectionAlert(@localList.ID)">Decline</button>
                            }
                        </div>
                    </div>
                </div>
            </div>

        }
    </div>
    <!-- Party Lists -->
    <h3>القوائم الحزبية</h3>
    <div class="row">
        @foreach (var partyList in Model.PartyLists)
        {
            <div class="col-md-4 mb-4 list-card" data-list-name="@partyList.Party_Name">
                <div class="card h-100 shadow-sm">
                    <div class="card-header text-white" style="background-color: #002d72;">
                        @partyList.Party_Name
                    </div>
                    <div class="card-body">
                        <p>Circle ID: @partyList.List_Name</p>
                        @if (!string.IsNullOrEmpty(partyList.List_Logo))
                        {
                            <img src="@Url.Content("~/Content/Uploads/" + partyList.List_Logo)" alt="Local List Image" class="img-fluid" />
                        }
                        <h5 class="mb-3">المرشحين</h5>

                        @if (Model.PartyCandidatesByList.ContainsKey(partyList.ID))
                        {
                            <div class="table-responsive">
                                <table class="table table-bordered table-sm">
                                    <thead class="table-light">
                                        <tr>
                                            <th>الرقم الوطني</th>
                                            <th>الاسم</th>
                                            <th>الجنس</th>
                                            <th>الدين</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var candidate in Model.PartyCandidatesByList[partyList.ID])
                                        {
                                            <tr>
                                                <td>@candidate.National_ID</td>
                                                <td>@candidate.Name</td>
                                                <td>@candidate.Gender</td>
                                                <td>@candidate.Religion</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        }
                        else
                        {
                            <p class="text-center text-muted">لا يوجد مرشحين</p>

                        }
                    </div>

                    <div class="card-footer text-center">

                        <div id="partyListActions_@partyList.ID">
                            @if (partyList.Status == "Approved" || partyList.Status == "Rejected")
                            {
                                <span class="status-text">@partyList.Status</span>
                            }
                            else
                            {
                                <button class="btn btn-success" onclick="showApprovalAlert(@partyList.ID)">Approve</button>
                                <button class="btn btn-danger" onclick="showRejectionAlert(@partyList.ID)">Decline</button>
                            }
                        </div>
                    </div>
                </div>
            </div>

        }
    </div>

    <style>
        .list-card {
            transition: transform 0.2s ease-in-out;
        }

            .list-card:hover {
                transform: translateY(-5px);
            }

        .card-header {
            background-color: #002d72; /* Apply the same color */
        }

        html,
        body,
        .intro {
            height: 100%;
        }

        table {
            width: 100%;
            margin: 0 auto;
        }

            table td,
            table th {
                text-overflow: ellipsis;
                white-space: nowrap;
                overflow: hidden;
            }

        thead th {
            color: #fff;
        }

        .card {
            border-radius: .5rem;
        }

        .table-scroll {
            border-radius: .5rem;
        }

        thead {
            top: 0;
            position: sticky;
        }
    </style>
